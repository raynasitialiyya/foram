"use strict";var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function touchHandler(e){var t=e.changedTouches[0],n=document.createEvent("MouseEvent");n.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],!0,!0,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n),"touchmove"==e.type&&e.preventDefault()}function touchInit(e,t){e.addEventListener("touchmove",touchHandler,!0),e.addEventListener("touchend",touchHandler,!0),e.addEventListener("touchcancel",touchHandler,!0)}var MindatOverlay=function(){function e(t){_classCallCheck(this,e);var n={viewer:null,type:"point",location:null,placement:OpenSeadragon.OverlayPlacement.LEFT,color:"#b71c1c",text:"New annotation",isExpanded:!1,editable:!1};this.options=$.extend(!0,{},n,t),"rect"==this.options.type?this.options.location=new OpenSeadragon.Rect(this.options.location.x,this.options.location.y,this.options.location.width,this.options.location.height):this.options.location=new OpenSeadragon.Point(this.options.location.x,this.options.location.y),this.editable=this.options.editable,this.color=this.options.color,this.type=this.options.type,this.viewer=this.options.viewer,this.location=this.options.location,this.placement=this.options.placement,this.parent=this.options.parent,this.container=this.viewer.container,this.element=null,this.arrowElement=null,this.expElement=null,this.textElement=null,this.textEditElement=null,this.controlsElement=null,this.bodyElement=null,this.text=null,this.rect=null,this.buttons=null,this.overlay=null,this.isEditing=!1,this.isTextEditing=!1,this.deleted=!1,this.trackers=[],"point"==this.options.type&&this.createPointOverlay(this.options.location,this.options.placement),"rect"==this.options.type&&(this.createRectOverlay(this.options.location),this.viewer.addHandler("open",this.draw.bind(this)),this.viewer.addHandler("animation",this.draw.bind(this)),this.viewer.addHandler("resize",this.draw.bind(this)),this.viewer.addHandler("rotate",this.draw.bind(this))),"HTML"==this.options.type&&this.createHTMLOverlay(this.options.location,this.options.placement)}return _createClass(e,[{key:"createRectElement",value:function(){if(!this.rectElement){this.rectElement=document.createElement("div"),this.rectElement.className="overlay-rect editable";var e=null;this.editable&&((e=document.createElement("div")).className="resize-handle",e.style.display="none",this.rectElement.appendChild(e),this.resizeHandle=e)}}},{key:"createRectOverlay",value:function(e){var t=this,n=this.element;if(null==this.viewer.getOverlayById(n)){this.createPointElement(),this.createRectElement(),this.rectOverlay=new OpenSeadragon.Overlay(this.rectElement,e||new OpenSeadragon.Rect),this.rect=e;var i=this.normalizeRect(e),a=new OpenSeadragon.Point(i.x,i.y),s=this.placement||OpenSeadragon.OverlayPlacement.LEFT;this.createPointOverlay(a,s),this.expElement=this.element;var o=this.trackers.find((function(e){return e.element===t.arrowElement}));o&&o.destroy(),o=new OpenSeadragon.MouseTracker({element:this.rectElement,clickHandler:this.onArrowClick.bind(this)}).setTracking(!0),this.trackers.push(o),this.editable&&(o=new OpenSeadragon.MouseTracker({element:this.resizeHandle,dragHandler:this.onResizeHanleDrag.bind(this),dragEndHandler:this.onResizeHandleDragEnd.bind(this)}),this.trackers.push(o),o=new OpenSeadragon.MouseTracker({element:this.rectElement,dragHandler:this.onRectOverlayDrag.bind(this)}),this.trackers.push(o)),this.element.style.display="none"}}},{key:"placeArrowForRect",value:function(e){e=e||this.overlay.placement||OpenSeadragon.OverlayPlacement.LEFT;var t=this.normalizeRect(this.rect),n=t.x,i=new OpenSeadragon.Point(3,3);i=this.viewer.viewport.deltaPointsFromPixels(i).x,$(this.arrowElement).removeClass("leftarrow rightarrow"),e==OpenSeadragon.OverlayPlacement.LEFT&&($(this.arrowElement).addClass("leftarrow"),n=n+t.width+i),e==OpenSeadragon.OverlayPlacement.RIGHT&&($(this.arrowElement).addClass("rightarrow"),n-=i);var a=t.y+t.height/2,s=new OpenSeadragon.Point(n,a),o=e;this.overlay.update(s,o),this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport)}},{key:"onResizeHanleDrag",value:function(e){if(this.editable){this.resizeHandle.style.display="none";var t=e.delta;t=this.viewer.viewport.deltaPointsFromPixels(t,!0),this.rect.width+=t.x,this.rect.height+=t.y;this.viewer.world.getHomeBounds();this.draw()}}},{key:"onResizeHandleDragEnd",value:function(){this.editable&&(this.resizeHandle.style.display="block",this.rect.width<0&&(this.rect.x+=this.rect.width,this.rect.width=Math.abs(this.rect.width)),this.rect.height<0&&(this.rect.y+=this.rect.height,this.rect.height=Math.abs(this.rect.height)))}},{key:"onRectOverlayDrag",value:function(e){if(this.editable){var t=this.viewer;this.dragDist+=Math.abs(e.delta.x)+Math.abs(e.delta.y);var n=t.viewport.deltaPointsFromPixels(e.delta,!0);this.rect&&(this.rect.x+=n.x,this.rect.y+=n.y),this.draw()}}},{key:"createHTMLElement",value:function(){var e=this,t=this.options.text,n=document.createElement("div");n.innerHTML=t;var i=null,a=null;if(this.editable){(i=document.createElement("div")).className="overlay-toolbar";var s=null;this.buttons=[],["edit","done","placement","type","delete"].forEach((function(t){if((s=document.createElement("div")).className="overlay-toolbar-button "+t,"type"==t&&(s.className=s.className+" "+e.type),"placement"==t){s.id="placementPicker";var n=document.createElement("div");n.className="placement-palette",n.id="placementPalette";var a="";["TOP_LEFT","TOP","TOP_RIGHT","LEFT","CENTER","RIGHT","BOTTOM_LEFT","BOTTOM","BOTTOM_RIGHT"].forEach((function(e){a+='<div class="placement-option" id="'+e+'"></div>'})),n.innerHTML=a,s.appendChild(n),e.placementPalette=n}i.appendChild(s),e.buttons.push(s)})),(a=document.createElement("textarea")).setAttribute("rows","8"),a.setAttribute("cols","30"),a.className="overlay-text-edit",document.body.appendChild(a)}var o=document.createElement("div");o.className="overlay-whole",o.appendChild(n),i&&o.appendChild(i),this.element=o,this.bodyElement=n,this.controlsElement=i,this.textEditElement=a,this.text=t}},{key:"createPointElement",value:function(){var e=this,t=this.options.text,n=document.createElement("div");n.className="overlay-body-arrow",this.options.placement==OpenSeadragon.OverlayPlacement.LEFT&&(n.className=n.className+" leftarrow"),this.options.placement==OpenSeadragon.OverlayPlacement.RIGHT&&(n.className=n.className+" rightarrow");var i=document.createElement("div");i.className="triangle",n.appendChild(i);var a=document.createElement("div");a.className="overlay-body-expandable-text",a.innerHTML=t;var s=document.createElement("div");s.className="overlay-body-expandable",this.options.isExpanded?s.style.display="inline-block":s.style.display="none",s.appendChild(a);var o=document.createElement("div");o.className="overlay-body",o.appendChild(n),o.appendChild(s);var r=null,l=null;if(this.editable){(r=document.createElement("div")).className="overlay-toolbar";var d=null;this.buttons=[],["edit","done","color","placement","type","delete"].forEach((function(t){if((d=document.createElement("div")).className="overlay-toolbar-button "+t,"type"==t&&(d.className=d.className+" "+e.type),"color"==t){d.id="colorPicker";var n=document.createElement("div");n.className="palette",n.id="colorPalette";var i="";["#ff6f00","#f44336","#b71c1c","#880e4f","#7b1fa2","#1a237e","#1565c0","#1b5e20","#827717"].forEach((function(e){i+='<div class="color-option" style="background-color:'+e+'"></div>'})),n.innerHTML=i,d.appendChild(n),e.colorPalette=n}if("placement"==t){d.id="placementPicker";var a=document.createElement("div");a.className="placement-palette",a.id="placementPalette";var s=[];switch(e.type){case"point":case"rect":s=["LEFT","RIGHT"],a.className="placement-palette two";break;case"html":s=["TOP_LEFT","TOP","TOP_RIGHT","LEFT","CENTER","RIGHT","BOTTOM_LEFT","BOTTOM","BOTTOM_RIGHT"]}var o="";s.forEach((function(e){o+='<div class="placement-option" id="'+e+'"></div>'})),a.innerHTML=o,d.appendChild(a),e.placementPalette=a}r.appendChild(d),e.buttons.push(d)})),(l=document.createElement("textarea")).setAttribute("rows","4"),l.setAttribute("cols","30"),l.className="overlay-text-edit",document.body.appendChild(l)}var h=document.createElement("div");h.className="overlay-whole",h.appendChild(o),r&&h.appendChild(r),this.element=h,this.bodyElement=o,this.controlsElement=r,this.textEditElement=l,this.arrowElement=n,this.expElement=s,this.noteElement=s,this.textElement=a,this.text=t,this.chooseColor(this.options.color)}},{key:"chooseColor",value:function(e,t){this.color=e,this.buttons&&(this.buttons[2].style.backgroundColor=this.color),this.noteElement.style.backgroundColor=e;var n,i=this.arrowElement;if((i.classList.contains("rightarrow")||i.classList.contains("leftarrow"))&&(i.firstChild.style.borderColor="transparent "+e+" transparent "+e),this.rectElement){if(e.includes("#")){e="rgb("+(n=e,n.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,i){return"#"+t+t+n+n+i+i})).substring(1).match(/.{2}/g).map((function(e){return parseInt(e,16)}))).join(", ")+")"}var a=e.replace(")",", 1.0)").replace("rgb","rgba"),s=e.replace(")",", 0.4)").replace("rgb","rgba");this.rectElement.style.boxShadow="0 0 0 3px "+a+", 0 0 0 0.8em "+s,this.rectElement.style.borderColor=a}if(!t){var o=new Event("m-overlay-edit-color");this.bodyElement.dispatchEvent(o)}}},{key:"choosePlacement",value:function(e){$(this.arrowElement).removeClass("leftarrow rightarrow");var t=OpenSeadragon.Placement[e.toUpperCase()];t==OpenSeadragon.OverlayPlacement.LEFT&&$(this.arrowElement).addClass("leftarrow"),t==OpenSeadragon.OverlayPlacement.RIGHT&&$(this.arrowElement).addClass("rightarrow");var n=new OpenSeadragon.Point(this.overlay.location.x,this.overlay.location.y);this.rectElement?this.placeArrowForRect(t):(this.overlay.update(n,t),this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport))}},{key:"startEditing",value:function(){if(!this.isEditing&&this.editable){this.isEditing=!0,this.controlsElement.style.display="block";var e=new Event("m-overlay-edit-start");this.bodyElement.dispatchEvent(e)}}},{key:"finishEditing",value:function(e){if(this.isEditing&&("HTML"!=this.type||e)&&(this.isEditing=!1,this.controlsElement.style.display="none",this.colorPalette&&(this.colorPalette.style.display="none"),this.placementPalette.style.display="none",this.finishTextEditing(e),this.expElement&&this.alignArrow(this.expElement),!e)){var t=new Event("m-overlay-edit-finish");this.bodyElement.dispatchEvent(t)}}},{key:"placeTextEdit",value:function(){var e=$(this.element),t=e.offset().top+e.height()+3,n=e.offset().left;this.textEditElement.style.top=t+"px",this.textEditElement.style.left=n+"px"}},{key:"startTextEditing",value:function(){this.isTextEditing||(this.isTextEditing=!0,this.buttons[0].style.display="none",this.buttons[1].style.display="inline-block",this.textEditElement.value=this.text,this.placeTextEdit(),this.textEditElement.style.display="block")}},{key:"finishTextEditing",value:function(e){if(this.isTextEditing&&(this.isTextEditing=!1,this.buttons[1].style.display="none",this.buttons[0].style.display="inline-block",this.text=this.textEditElement.value,"HTML"==this.type?this.bodyElement.innerHTML=this.text:this.textElement.innerHTML=this.text,this.textEditElement.style.display="none",this.expElement&&this.alignArrow(this.expElement),!e)){var t=new Event("m-overlay-textedit-finish");this.bodyElement.dispatchEvent(t)}}},{key:"onBodyPress",value:function(e){this.dragDist=0}},{key:"onBodyRelease",value:function(e){this.editable&&(this.dragDist>5||("block"!=this.controlsElement.style.display?this.startEditing():this.finishEditing()))}},{key:"onArrowClick",value:function(e){(e.quick||0==this.mode)&&(this.toggle(),this.viewer.updateOverlay(this.element,this.overlay.location,this.overlay.placement))}},{key:"createHTMLOverlay",value:function(e,t,n){var i=this;this.options.text&&"New annotation"!=this.options.text||(this.options.text='<div style="width: 6em; height: 4em; background-color: rgba(0,0,0,0.5); color: white;">default html overlay</div>'),this.createHTMLElement();var a=n||this.element,s=null,o=this.viewer;if(o.addOverlay(a,e,t),this.overlay=o.getOverlayById(a),this.editable){this.textEditElement&&(this.textEditElement.addEventListener("keydown",(function(e){(e.ctrlKey||e.shiftKey)&&13==e.keyCode&&(e.preventDefault(),i.finishEditing()),e.stopImmediatePropagation()})),this.textEditElement.addEventListener("input",(function(e){e.stopImmediatePropagation()})),s=new OpenSeadragon.MouseTracker({element:this.textEditElement}).setTracking(!0),this.trackers.push(s)),this.viewer.addHandler("open",this.placeTextEdit.bind(this)),this.viewer.addHandler("animation",this.placeTextEdit.bind(this)),this.viewer.addHandler("resize",this.placeTextEdit.bind(this)),this.viewer.addHandler("rotate",this.placeTextEdit.bind(this));new OpenSeadragon.MouseTracker({element:this.controlsElement}).setTracking(!0),this.buttons[3].style.display="none",s=new OpenSeadragon.MouseTracker({element:this.buttons[0],clickHandler:this.startTextEditing.bind(this)}).setTracking(!0),this.trackers.push(s),s=new OpenSeadragon.MouseTracker({element:this.buttons[1],clickHandler:function(e){i.finishTextEditing();var t=new Event("m-overlay-edit-finish");i.bodyElement.dispatchEvent(t)}.bind(this)}).setTracking(!0),this.trackers.push(s),s=new OpenSeadragon.MouseTracker({element:this.buttons[2],clickHandler:function(e){var t=e.originalEvent.target;t.classList.contains("placement")&&("block"!=i.placementPalette.style.display?i.placementPalette.style.display="block":i.placementPalette.style.display="none"),"placement-option"==t.className&&(i.choosePlacement(t.id),i.placementPalette.style.display="none")}.bind(this)}).setTracking(!0),this.trackers.push(s),s=new OpenSeadragon.MouseTracker({element:this.buttons[4],clickHandler:this.onDeleteClick.bind(this)}).setTracking(!0),this.trackers.push(s),s=new OpenSeadragon.MouseTracker({element:this.bodyElement,pressHandler:this.onBodyPress.bind(this),releaseHandler:this.onBodyRelease.bind(this),dragHandler:function(e,t){if(this.editable){this.dragDist+=Math.abs(t.delta.x)+Math.abs(t.delta.y);var n=o.viewport.deltaPointsFromPixels(t.delta,!0),i=e.position,a=new OpenSeadragon.Point(i.x+n.x,i.y+n.y);o.updateOverlay(e.element,a,e.placement),this.placeTextEdit()}}.bind(this,this.overlay)}).setTracking(!0),this.trackers.push(s)}touchInit(this.container,this.bodyElement)}},{key:"switchPointRect",value:function(){}},{key:"createPointOverlay",value:function(e,t,n){var i=this;this.createPointElement();var a=n||this.element,s=this.viewer,o=function(e,t){if(this.editable){this.dragDist+=Math.abs(t.delta.x)+Math.abs(t.delta.y);var n=s.viewport.deltaPointsFromPixels(t.delta,!0),i=e.position,a=new OpenSeadragon.Point(i.x+n.x,i.y+n.y);if(s.updateOverlay(e.element,a,e.placement),this.rectOverlay){var o=this.rectOverlay,r=o.position;this.rect=new OpenSeadragon.Rect(r.x+n.x,r.y+n.y,o.width,o.height),this.draw()}this.placeTextEdit()}};s.addOverlay(a,e,t),this.overlay=s.getOverlayById(a),this.alignArrow(this.expElement);var r=null;if(r=new OpenSeadragon.MouseTracker({element:this.arrowElement,clickHandler:this.onArrowClick.bind(this)}).setTracking(!0),this.trackers.push(r),this.editable){this.textEditElement.addEventListener("keydown",(function(e){(e.ctrlKey||e.shiftKey)&&13==e.keyCode&&(e.preventDefault(),i.finishEditing()),e.stopImmediatePropagation()})),this.textEditElement.addEventListener("input",(function(e){e.stopImmediatePropagation()})),r=new OpenSeadragon.MouseTracker({element:this.textEditElement}).setTracking(!0),this.trackers.push(r),this.viewer.addHandler("open",this.placeTextEdit.bind(this)),this.viewer.addHandler("animation",this.placeTextEdit.bind(this)),this.viewer.addHandler("resize",this.placeTextEdit.bind(this)),this.viewer.addHandler("rotate",this.placeTextEdit.bind(this));new OpenSeadragon.MouseTracker({element:this.controlsElement}).setTracking(!0),r=new OpenSeadragon.MouseTracker({element:this.buttons[0],clickHandler:this.startTextEditing.bind(this)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.buttons[1],clickHandler:function(e){i.finishTextEditing();var t=new Event("m-overlay-edit-finish");i.bodyElement.dispatchEvent(t)}.bind(this)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.buttons[2],clickHandler:function(e){var t=e.originalEvent.target;t.classList.contains("color")&&("block"!=i.colorPalette.style.display?i.colorPalette.style.display="block":i.colorPalette.style.display="none"),"color-option"==t.className&&(i.chooseColor(t.style.backgroundColor),i.colorPalette.style.display="none")}.bind(this)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.buttons[3],clickHandler:function(e){var t=e.originalEvent.target;t.classList.contains("placement")&&("block"!=i.placementPalette.style.display?i.placementPalette.style.display="block":i.placementPalette.style.display="none"),"placement-option"==t.className&&(i.choosePlacement(t.id),i.placementPalette.style.display="none")}.bind(this)}).setTracking(!0),r=new OpenSeadragon.MouseTracker({element:this.buttons[4],clickHandler:function(e){i.switchPointRect()}.bind(this)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.buttons[5],clickHandler:this.onDeleteClick.bind(this)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.bodyElement,pressHandler:this.onBodyPress.bind(this),releaseHandler:this.onBodyRelease.bind(this),dragHandler:o.bind(this,this.overlay)}).setTracking(!0),this.trackers.push(r),r=new OpenSeadragon.MouseTracker({element:this.arrowElement,dragHandler:o.bind(this,this.overlay)}).setTracking(!0),this.trackers.push(r)}touchInit(this.container,this.bodyElt)}},{key:"normalizeRect",value:function(e){var t=null;return(t=e?e.clone():this.rect).width<0&&(t.x+=t.width,t.width*=-1),t.height<0&&(t.y+=t.height,t.height*=-1),t}},{key:"drawRect",value:function(e){return e&&this.overlay&&(this.overlay.update(function(e){var t=e.clone();return t.width<0&&(t.x+=t.width,t.width*=-1),t.height<0&&(t.y+=t.height,t.height*=-1),t}(e)),this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport),this.rect=e),this}},{key:"draw",value:function(){var e,t;return this.rect&&this.rectOverlay&&(this.rectOverlay.update((e=this.rect,(t=e.clone()).width<0&&(t.x+=t.width,t.width*=-1),t.height<0&&(t.y+=t.height,t.height*=-1),t)),this.rectOverlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport),this.placeArrowForRect()),this}},{key:"rectDisplayHandleAndArrow",value:function(){this.rect&&this.rectOverlay&&(this.element.style.display="block",this.resizeHandle&&(this.resizeHandle.style.display="block"),this.placeArrowForRect(),this.draw())}},{key:"deltaRect",value:function(e){this.rect.x+=e.x,this.rect.y+=e.y}},{key:"setText",value:function(e){this.textElement.innerHTML=e,this.text=e}},{key:"setColor",value:function(e){}},{key:"hide",value:function(){this.element.style.display="none",this.rectElement&&(this.rectElement.style.display="none")}},{key:"show",value:function(){this.disabled||(this.rectElement?(this.rectElement.style.display="block",this.options.isExpanded&&(this.element.style.display="block",this.alignArrow(this.expElement))):(this.element.style.display="block",this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport)))}},{key:"toggle",value:function(){this.options.isExpanded?this.collapse():this.expand()}},{key:"destroy",value:function(){this.isEditing=!1,this.editable=!1,this.deleted=!0,this.viewer.removeOverlay(this.element),this.overlay=null,this.textEditElement.remove(),this.element.remove(),this.rectOverlay&&(this.rectOverlay=null,this.rectElement.remove(),this.rect=null)}},{key:"onDeleteClick",value:function(e){var t=this;this.isEditing=!1,this.editable=!1,this.deleted=!0,this.element&&(this.element.style.display="none"),e.isTouchEvent?e.originalEvent.target.addEventListener("touchend",(function(){t.destroy()})):this.destroy()}},{key:"alignArrow",value:function(e){if(this.arrowElement){var t=e.offsetHeight/2;this.arrowElement.style.top=t+"px",this.overlay.drawHTML(this.viewer.drawer.container,this.viewer.viewport)}}},{key:"collapse",value:function(){this.expElement&&(this.expElement.style.display="none"),this.options.isExpanded=!1,this.finishEditing(),this.alignArrow(this.arrowElement)}},{key:"expand",value:function(){this.expElement&&(this.expElement.style.display="inline-block"),this.options.isExpanded=!0,this.alignArrow(this.expElement)}}]),e}(),drawBetweenObjects=function(){function e(t){var n=this;_classCallCheck(this,e);var i;this.options=$.extend(!0,{},{lines:[],resizeDelay:40},t),this.lines=this.options.lines,this.updateLines(),$(window).resize((function(){clearTimeout(i),0!==t.delay?i=setTimeout(a,this.options.delay):this.updateLines()}));var a=function(){n.updateLines()}}return _createClass(e,[{key:"addLine",value:function(e,t){var n={start:e,end:t};this.lines.find(x.start.id===n.start.id&&x.end.id===n.end.id)||(this.lines.push(n),drawLine(n))}},{key:"removeLine",value:function(e){this.lines=this.lines.filter((function(t){return!(t.start.id===e.start.id&&t.end.id===e.end.id)}));var t="line_"+e.start.attr("id")+"_"+e.end.attr("id");$("#"+t).remove(),$("#"+t+"_shadow").remove()}},{key:"drawLine",value:function(e){var t=e.start,n=e.end,i="line_"+t.attr("id")+"_"+n.attr("id");if(!0!==i.includes("undefined")){$("#"+i).remove(),$("#"+i+"_shadow").remove();var a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("class","line"),a.setAttribute("id",i);var s=$("#OSDsvg").offset(),o=t.offset().left-s.left+t.width()/2,r=t.offset().top-s.top+t.height()/2,l=n.offset().left-s.left+n.width()/2,d=n.offset().top-s.top+n.height()/2;if(a.setAttribute("x1",o),a.setAttribute("y1",r),a.setAttribute("x2",l),a.setAttribute("y2",d),!$("#mDash").length){var h=document.createElementNS("http://www.w3.org/2000/svg","marker");h.setAttribute("id","mDash"),h.setAttribute("class","line"),h.setAttribute("markerWidth","1"),h.setAttribute("markerHeight","4"),h.setAttribute("refX","0"),h.setAttribute("refY","2"),h.setAttribute("orient","auto");var c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 0 0 0 8"),h.append(c);var u=h.cloneNode(!0);u.setAttribute("id","mDash2"),u.firstChild.setAttribute("style","stroke-width: 7px; stroke: rgb(0,0,0)");var v=document.createElementNS("http://www.w3.org/2000/svg","defs");v.append(h),v.append(u),$("#OSDsvg").prepend(v)}a.setAttribute("style","marker-start: url(#mDash); marker-end: url(#mDash);");var p=a.cloneNode(!0);p.setAttribute("style","stroke-width: 6px; stroke: rgb(0,0,0); marker-start: url(#mDash2); marker-end: url(#mDash2);"),p.setAttribute("id",i+"_shadow"),$("#OSDsvg").children("g").append(p),$("#OSDsvg").children("g").append(a)}}},{key:"updateLines",value:function(){var e=this;this.lines.forEach((function(t){return e.drawLine(t)}))}},{key:"searchLines",value:function(e){$(".deleteMe").remove(),$(e).each((function(t,n){e.eq(t+1).length&&this.drawLine(this.options.line,$(this),e.eq(t+1))}))}}]),e}(),lineOverlay=function(){function e(t){_classCallCheck(this,e);var n={start:null,end:null,element:null,placement:OpenSeadragon.OverlayPlacement.CENTER};this.container=document.getElementById("container"),this.options=$.extend({},n,t),this.viewer=t.viewer,this.start=t.start,this.end=t.end,this.startOverlay=this.createPointOverlay("line-start",this.start,this.options.placement),this.endOverlay=this.createPointOverlay("line-end",this.end,this.options.placement),this.drawBetweenObjects=new drawBetweenObjects({lines:[{start:$(this.startOverlay.element),end:$(this.endOverlay.element)}]}),this.viewer.addHandler("open",this.drawBetweenObjects.updateLines.bind(this.drawBetweenObjects)),this.viewer.addHandler("animation",this.drawBetweenObjects.updateLines.bind(this.drawBetweenObjects)),this.viewer.addHandler("resize",this.drawBetweenObjects.updateLines.bind(this.drawBetweenObjects)),this.viewer.addHandler("rotate",this.drawBetweenObjects.updateLines.bind(this.drawBetweenObjects))}return _createClass(e,[{key:"getLength",value:function(){var e=this.startOverlay.position,t=this.endOverlay.position;return Math.hypot(e.x-t.x,e.y-t.y)}},{key:"createHandleElement",value:function(e){var t=document.createElement("div");return t.id=e,t.className="line-handle "+e,t}},{key:"createPointOverlay",value:function(e,t,n){var i=this.createHandleElement(e),a=this.viewer;a.addOverlay(i,t,n);var s=a.getOverlayById(i);return s.drawHTML(a.drawer.container,a.viewport),new OpenSeadragon.MouseTracker({element:i,dragHandler:function(e,t){var n=t.delta;n=a.viewport.deltaPointsFromPixels(n,!0);var i=e.position,s=new OpenSeadragon.Point(i.x+n.x,i.y+n.y);a.updateOverlay(e.element,s,e.placement),e.drawHTML(a.drawer.container,a.viewport),this.drawBetweenObjects.updateLines()}.bind(this,s)}),touchInit(this.container,i),s}},{key:"destroy",value:function(){this.drawBetweenObjects.removeLine({start:$(this.startOverlay.element),end:$(this.endOverlay.element)}),this.drawBetweenObjects.updateLines=null,this.startOverlay.destroy(),this.endOverlay.destroy()}},{key:"update",value:function(e,t){var n=this.viewer;n.updateOverlay(this.endOverlay.element,e,this.endOverlay.placement),this.endOverlay.drawHTML(n.drawer.container,n.viewport),t&&(n.updateOverlay(this.startOverlay.element,t,this.startOverlay.placement),this.startOverlay.drawHTML(n.drawer.container,n.viewport)),this.drawBetweenObjects.updateLines()}}]),e}(),MindatOverlayManager=function(){function e(t,n,i){_classCallCheck(this,e);var a={hideOnStart:!0,editable:!1,mode:1,container:t.container.parentNode,overlays:[],labelTexts:[],labelColors:["#ff6f00","#f44336","#b71c1c","#7b1fa2","#1a237e","#1565c0","#1b5e20","#827717"],disabled:0,cuhrte:0};this.viewer=t,this.mode=0,this.options=$.extend({},a,n),this.options.cuhrte&&(this.options.editable=!0),this.editable=this.options.editable,this.mousetrackerCanvas={},this.container=this.options.container,this.mindatOverlays=[],this._mouseMoved=!1,this._pinchDetected=!1,this.options.overlays&&this.loadOverlays(this.options.overlays),this.switchMode(9),this.initAnnotationsMenu()}return _createClass(e,[{key:"initAnnotationsMenu",value:function(){var e=this;if(0!=this.count()||this.options.cuhrte){var t=document.createElement("div");t.id="menu-annotations-labels-cont",this.container.appendChild(t);var n=document.createElement("div");n.id="menu-annotations",n.className="menu-annotations",n.style.display="block",n.innerHTML='\n        <div id="menu-annotations-btn-cont"><div class="menu-annotations-h">Annotations</div></div>\n        <div id="menu-annotations-btn2-cont">\n          <button id="menu-annotations-show" class="menu-annotations-btn2">Show</button>\n          <button id="menu-annotations-hide" class="menu-annotations-btn2">Hide</button>\n          <button id="menu-annotations-edit" class="menu-annotations-btn2">Edit</button>          \n          <button id="menu-annotations-save" class="menu-annotations-btn2">Save and finish</button>\n          <button id="menu-annotations-expand" class="menu-annotations-btn2">Expand all</button>\n          <button id="menu-annotations-collapse" class="menu-annotations-btn2">Collapse all</button>\n        </div>\n        <div id="menu-annotations-btn3-cont">\n          <button id="menu-annotations-point" class="menu-annotations-btn selected"><div></div></button>\n          <button id="menu-annotations-rect" class="menu-annotations-btn"><div></div></button>\n          <button id="menu-annotations-html" class="menu-annotations-btn"><div></div></button>\n        </div>\n        <div id="menu-annotations-hint-point" class="menu-annotations-hint">To add a <span class="hint-text-highlight">point</span> annotation<br>click on the photo or drag-and-drop a label with mineral name</div>\n        <div id="menu-annotations-hint-rect" class="menu-annotations-hint">To add a <span class="hint-text-highlight">rectangle</span> annotation<br>draw a rectangle on the photo or drag-and-drop a label with mineral name</div>\n        <div id="menu-annotations-hint-html" class="menu-annotations-hint">To add an <span class="hint-text-highlight">HTML</span> annotation<br>click on the photo.<br>This option is available only for managers. </div>        \n        ',this.container.appendChild(n),$(".menu-annotations-btn2").hide(),2!==this.options.cuhrte&&$("#menu-annotations-html").remove(),this.options.cuhrte&&(0==this.count()&&($("#menu-annotations-edit").html("Add"),$("#menu-annotations-show").hide()),$("#menu-annotations-edit").show()),$("#menu-annotations-show").on("click",(function(t){$("#menu-annotations-show").hide(),$("#menu-annotations-hide").show(),$("#menu-annotations-expand").show(),$("#menu-annotations-collapse").show(),e.showAll(),t.stopPropagation()})),$("#menu-annotations-hide").on("click",(function(t){$("#menu-annotations-show").show(),$("#menu-annotations-hide").hide(),$("#menu-annotations-expand").hide(),$("#menu-annotations-collapse").hide(),e.hideAll(),t.stopPropagation()})),$("#menu-annotations-expand").on("click",(function(t){e.expandAll(),t.stopPropagation()})),$("#menu-annotations-collapse").on("click",(function(t){e.collapseAll(),t.stopPropagation()})),$("#menu-annotations-edit").on("click",(function(n){$("#menu-annotations-show").hide(),$("#menu-annotations-hide").hide(),$("#menu-annotations-edit").hide(),$("#menu-annotations-expand").show(),$("#menu-annotations-collapse").show(),$("#menu-annotations-save").show(),$("#menu-annotations-btn3-cont").show(),$(".menu-annotations-hint").hide(),$("#menu-annotations-hint-point").show(),$("#"+t.id).show(),e.showAll(),e.switchMode(1),$(".menu-annotations-btn.selected").removeClass("selected"),$("#menu-annotations-point").addClass("selected"),n.stopPropagation()})),$("#menu-annotations-save").on("click",(function(n){e.count()>0?($("#menu-annotations-edit").html("Edit"),$("#menu-annotations-hide").show()):($("#menu-annotations-edit").html("Add"),$("#menu-annotations-expand").hide(),$("#menu-annotations-collapse").hide()),e.switchMode(9),$("#"+t.id).hide(),$("#menu-annotations-edit").show(),$("#menu-annotations-save").hide(),$("#menu-annotations-btn3-cont").hide(),$(".menu-annotations-hint").hide(),n.stopPropagation()})),$("#menu-annotations-point").on("click",(function(t){$("#menu-annotations-point").hasClass("selected")||($(".menu-annotations-btn.selected").removeClass("selected"),$("#menu-annotations-point").addClass("selected"),$(".menu-annotations-hint").hide(),$("#menu-annotations-hint-point").show(),e.switchMode(1))})),$("#menu-annotations-rect").on("click",(function(t){$("#menu-annotations-rect").hasClass("selected")||($(".menu-annotations-btn.selected").removeClass("selected"),$("#menu-annotations-rect").addClass("selected"),$(".menu-annotations-hint").hide(),$("#menu-annotations-hint-rect").show(),e.switchMode(2))})),$("#menu-annotations-html").on("click",(function(t){$("#menu-annotations-html").hasClass("selected")||($(".menu-annotations-btn.selected").removeClass("selected"),$("#menu-annotations-html").addClass("selected"),$(".menu-annotations-hint").hide(),$("#menu-annotations-hint-html").show(),e.switchMode(5))})),this.count()>0&&(this.options.hideOnStart?$("#menu-annotations-hide").click():($("#menu-annotations-show").click(),$("#menu-annotations-collapse").click()))}}},{key:"count",value:function(){var e=0;return this.mindatOverlays.forEach((function(t){t.deleted||e++})),e}},{key:"hideAll",value:function(){this.mindatOverlays.forEach((function(e){e.hide()}))}},{key:"showAll",value:function(){this.mindatOverlays.forEach((function(e){e.deleted||e.show()}))}},{key:"expandAll",value:function(){this.mindatOverlays.forEach((function(e){e.deleted||e.expand()}))}},{key:"collapseAll",value:function(){this.mindatOverlays.forEach((function(e){e.deleted||e.collapse()}))}},{key:"getOverlaysData",value:function(){var e=this,t=this.options.labelTexts.map((function(t,n){return{labelText:t,labelColor:e.options.labelColors[n]}})),n=[],i=null;this.mindatOverlays.forEach((function(e){if(!e.deleted){i="rect"==e.type?e.rect:e.overlay.location;var t={type:e.type,location:i,placement:e.overlay.placement,color:e.color,text:e.text,parent:e.options.parent};n.push(t)}}));var a={labelColors:t,overlays:n};return 0==n.length&&(a={}),a}},{key:"getOverlaysTexts",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" --- ",t="",n=0;return this.mindatOverlays.forEach((function(i){i.deleted||i.parent==i.text||(n&&(t+=e),t+=i.text,n=1)})),t}},{key:"getOverlaysDataJSON",value:function(){var e=JSON.stringify(this.getOverlaysData());return"{}"==e&&(e=""),e}},{key:"loadOverlays",value:function(e,t){var n=this,i=!1;e.forEach((function(e){i=!1,"HTML"==e.type&&2==n.options.cuhrte&&(i=!0),"HTML"!=e.type&&n.options.cuhrte>0&&(i=!0);var a={viewer:n.viewer,type:e.type,location:e.location,placement:e.placement,color:e.color,text:e.text,parent:e.parent,isExpanded:t||!0,editable:i},s=new MindatOverlay(a);s.rectDisplayHandleAndArrow(),n.addCustomEventsListeners(s),n.mindatOverlays.push(s)}))}},{key:"switchMode",value:function(e){var t=this;if(e!=this.mode){var n=this.mode;if(this.mode=e,this.options.cuhrte||(this.mode=9),this.mousetrackerCanvas&&this.mousetrackerCanvas.element&&"function"==typeof this.mousetrackerCanvas.destroy&&this.mousetrackerCanvas.destroy(),9==this.mode&&this.mindatOverlays.forEach((function(e){n>0&&n<9&&e.finishEditing(!0),e.editable=!1,e.resizeHandle&&(e.resizeHandle.style.display="none")})),9==n&&(this.mindatOverlays.forEach((function(e){e.editable=!0,e.resizeHandle&&(e.resizeHandle.style.display="block"),"HTML"!=e.type||e.deleted||(2!==t.options.cuhrte?e.editable=!1:e.startEditing())})),this.mindatOverlays.forEach((function(e){}))),1!=this.mode&&5!=this.mode&&this.viewer.gestureSettingsMouse.clickToZoomPrev&&(this.viewer.gestureSettingsMouse.clickToZoom=this.viewer.gestureSettingsMouse.clickToZoomPrev),1==this.mode){this.mousetrackerCanvas=new OpenSeadragon.MouseTracker({element:this.viewer.canvas,pressHandler:this.onCanvasPressPoint.bind(this),releaseHandler:this.onCanvasReleasePoint.bind(this),pinchHandler:this.onCanvasPinch.bind(this),dragHandler:this.onCanvasDragPoint.bind(this),dragEndHandler:this.onCanvasDragEndPoint.bind(this)});var i=document.getElementById("menu-annotations-labels-cont");this.addDraggableLabels(i),this.viewer.gestureSettingsMouse.clickToZoom&&(this.viewer.gestureSettingsMouse.clickToZoomPrev=this.viewer.gestureSettingsMouse.clickToZoom,this.viewer.gestureSettingsMouse.clickToZoom=!1)}if(2==this.mode){this.mousetrackerCanvas=new OpenSeadragon.MouseTracker({element:this.viewer.canvas,dragHandler:this.onCanvasDragRect.bind(this),dragEndHandler:this.onCanvasDragEndRect.bind(this),pinchHandler:this.onCanvasPinch.bind(this)});i=document.getElementById("menu-annotations-labels-cont");this.addDraggableLabels(i)}3==this.mode&&(this.mousetrackerCanvas=new OpenSeadragon.MouseTracker({element:this.viewer.canvas,pressHandler:this.onCanvasPressLine.bind(this),dragHandler:this.onCanvasDragLine.bind(this),dragEndHandler:this.onCanvasDragEndLine.bind(this)})),5==this.mode&&(this.mousetrackerCanvas=new OpenSeadragon.MouseTracker({element:this.viewer.canvas,pressHandler:this.onCanvasPressPoint.bind(this),releaseHandler:this.onCanvasReleasePoint.bind(this),dragHandler:this.onCanvasDragPoint.bind(this)}),this.viewer.gestureSettingsMouse.clickToZoom&&(this.viewer.gestureSettingsMouse.clickToZoomPrev=this.viewer.gestureSettingsMouse.clickToZoom,this.viewer.gestureSettingsMouse.clickToZoom=!1))}}},{key:"onCanvasDragRect",value:function(e){if(this._mouseMoved=!0,!(this._pinchDetected||(this.dragDist+=Math.abs(e.delta.x)+Math.abs(e.delta.y),this.viewer.setMouseNavEnabled(!1),this.dragDist<10))){var t=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0),n=this.viewer.viewport.pointFromPixel(e.position,!0);if(this.currentRectOverlay)this.currentRectOverlay.rect.width+=t.x,this.currentRectOverlay.rect.height+=t.y,this.currentRectOverlay.draw();else{var i=new OpenSeadragon.Point(n.x-t.x,n.y-t.y),a=new OpenSeadragon.Rect(i.x,i.y,t.x,t.y),s=new MindatOverlay({viewer:this.viewer,type:"rect",location:a,isExpanded:!0,editable:this.editable});this.currentRectOverlay=s,this.mindatOverlays.push(s)}}}},{key:"onCanvasDragEndRect",value:function(e){this._pinchDetected;if(this._mouseMoved=!1,this._pinchDetected=!1,this.dragDist=0,this.currentRectOverlay){var t=this.currentRectOverlay;t.rectDisplayHandleAndArrow(),this.initSwitchPointRect(t),this.closeEditOthers(t),this.addCustomEventsListeners(t),this.currentRectOverlay.normalizeRect(),this.currentRectOverlay=null,this.viewer.setMouseNavEnabled(!0)}}},{key:"closeEditOthers",value:function(e){this.mindatOverlays.forEach((function(t){t!=e&&t.editable&&!t.deleted&&t.finishEditing()}))}},{key:"syncColorText",value:function(e){e.options.parent&&(document.getElementById("overlay-drag-label-"+e.options.parent).style.backgroundColor=e.color,this.options.labelColors[this.options.labelTexts.indexOf(e.options.parent)]=e.color,this.mindatOverlays.forEach((function(t){t!=e&&t.options.parent==e.options.parent&&(t.chooseColor(e.color,!0),t.text=e.text,t.textElement.innerHTML=e.text)})))}},{key:"addDraggableLabels",value:function(e,t,n){var i=this;function a(t){var n=t.eventSource.element,i=t.delta,o=parseFloat(n.style.left)||0,r=parseFloat(n.style.top)||0,l=null;n.classList.contains("dragging")?(o+=i.x,r+=i.y,n.style.left=o+"px",n.style.top=r+"px"):(l=n.cloneNode(!0),n.parentNode.insertBefore(l,n.nextSibling),new OpenSeadragon.MouseTracker({element:l,dragHandler:a.bind(this),dragEndHandler:s.bind(this)}),touchInit(e,l),n.classList.add("dragging"),o=o+n.offsetLeft+i.x,r=r+n.offsetTop+i.y,n.style.position="absolute",n.style.left=o+"px",n.style.top=r+"px")}function s(e){var t=e.eventSource.element.id.replace("overlay-drag-label-",""),n=e.eventSource.element.firstChild.innerHTML,i=e.eventSource.element.style.backgroundColor;e.eventSource.element.remove();var a=e.originalEvent,s=document.elementFromPoint(a.clientX,a.clientY);if(this.viewer.container.contains(s)){var o=$(this.viewer.container).offset().left,r=$(this.viewer.container).offset().top,l=new OpenSeadragon.Point(e.originalEvent.pageX-o,e.originalEvent.pageY-r);l=this.viewer.viewport.pointFromPixel(l,!0);var d={viewer:this.viewer,type:"point",location:l,placement:OpenSeadragon.OverlayPlacement.LEFT,text:n,color:i,isExpanded:!0,editable:this.editable,parent:t};if(2==this.mode){d.type="rect";var h=new OpenSeadragon.Point(40,40);h=this.viewer.viewport.deltaPointsFromPixels(h),d.location=new OpenSeadragon.Rect(l.x,l.y,h.x,h.y)}var c=new MindatOverlay(d);c.rectDisplayHandleAndArrow(),c.startEditing(),this.mindatOverlays.push(c),this.initSwitchPointRect(c),this.closeEditOthers(c),this.addCustomEventsListeners(c)}}t=t||this.options.labelTexts,n=n||this.options.labelColors,e&&Array.isArray(t)&&0!=t.length&&(e.innerHTML="",t.forEach((function(t,o){var r="green";Array.isArray(n)&&n.length>0&&(r=n[o%n.length]);var l=document.createElement("div");l.className="overlay-drag-label text",l.innerHTML=t;var d=document.createElement("div");d.id="overlay-drag-label-"+t,d.className="overlay-drag-label",d.style.backgroundColor=r,d.appendChild(l),e.appendChild(d),new OpenSeadragon.MouseTracker({element:d,dragHandler:a.bind(i),dragEndHandler:s.bind(i)})})))}},{key:"initSwitchPointRect",value:function(e){if(e.editable&&e.buttons){var t=new OpenSeadragon.MouseTracker({element:e.buttons[4],clickHandler:this.switchPointRect.bind(this,e)});e.trackers.push(t)}}},{key:"addCustomEventsListeners",value:function(e){var t=this;e&&(e.bodyElement.addEventListener("m-overlay-edit-start",this.closeEditOthers.bind(this,e)),e.bodyElement.addEventListener("m-overlay-edit-color",this.syncColorText.bind(this,e)),e.bodyElement.addEventListener("m-overlay-edit-finish",this.syncColorText.bind(this,e)),e.bodyElement.addEventListener("m-overlay-textedit-finish",(function(){2!=t.options.cuhrte&&"HTML"!=e.type&&(e.text=e.text.replace(/<[^>]+>/g,""),e.textElement.innerHTML=e.text)})))}},{key:"switchPointRect",value:function(e){if("point"==e.type||"rect"==e.type){var t=null,n=null,i=null,a=null;if("point"==e.type){t=e.overlay.location,n="rect";var s=new OpenSeadragon.Point(40,40);s=e.viewer.viewport.deltaPointsFromPixels(s),i=new OpenSeadragon.Rect(t.x,t.y,s.x,s.y)}else t=e.rect,n="point",i=new OpenSeadragon.Point(t.x,t.y);var o={viewer:e.viewer,type:n,location:i,placement:e.overlay.placement,color:e.color,text:e.text,parent:e.options.parent,isExpanded:!0,editable:!0};(a=new MindatOverlay(o)).rectDisplayHandleAndArrow(),this.initSwitchPointRect(a),this.addCustomEventsListeners(a),this.mindatOverlays.push(a),e.destroy()}}},{key:"onCanvasPressPoint",value:function(e){this._mouseMoved=!1,this.dragDist=0}},{key:"onCanvasReleasePoint",value:function(e){var t="point";if(5==this.mode&&(t="HTML"),e.quick,!(this.dragDist>5)){var n=this.viewer.viewport.pointFromPixel(e.position,!0),i=new MindatOverlay({viewer:this.viewer,type:t,location:n,placement:OpenSeadragon.OverlayPlacement.LEFT,isExpanded:!0,editable:this.editable});this.initSwitchPointRect(i),i.startEditing(),this.mindatOverlays.push(i),this.closeEditOthers.call(this,i),this.addCustomEventsListeners(i)}}},{key:"onCanvasClickPoint",value:function(e){e.quick;var t=new OpenSeadragon.Point(e.pageX,e.pageY),n=this.viewer.viewport.pointFromPixel(t,!0),i=new MindatOverlay({viewer:this.viewer,type:"point",location:n,placement:OpenSeadragon.OverlayPlacement.RIGHT,isExpanded:!0,editable:this.editable});this.mindatOverlays.push(i)}},{key:"onCanvasDragPoint",value:function(e){this._mouseMoved=!0,this.dragDist+=Math.abs(e.delta.x)+Math.abs(e.delta.y)}},{key:"onCanvasPinch",value:function(e){this._mouseMoved=!0,this._pinchDetected=!0,this.dragDist=Math.abs(e.distance)}},{key:"onCanvasDragEndPoint",value:function(e){this._mouseMoved=!1,this._pinchDetected=!1,this.dragDist=0}},{key:"onCanvasPressLine",value:function(e){this._mouseMoved=!1,this.dragDist=0,this.currentLineOverlay&&(this.currentLineOverlay.destroy(),this.currentLineOverlay=null)}},{key:"onCanvasDragLine",value:function(e){this._mouseMoved=!0,this.dragDist+=Math.abs(e.delta.x)+Math.abs(e.delta.y),this.viewer.setMouseNavEnabled(!1);var t=this.viewer.viewport.deltaPointsFromPixels(e.delta,!0),n=this.viewer.viewport.pointFromPixel(e.position,!0);if(this.currentLineOverlay)this.currentLineOverlay.update(n);else{var i=new OpenSeadragon.Point(n.x-t.x,n.y-t.y),a=new lineOverlay({viewer:this.viewer,start:i,end:n});this.currentLineOverlay=a}}},{key:"onCanvasDragEndLine",value:function(e){this.viewer.setMouseNavEnabled(!0)}}]),e}();